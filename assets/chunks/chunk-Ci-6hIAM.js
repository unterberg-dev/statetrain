import{c as L,Q as R,j as a,d as I,r as o,T as v,B as x,S as U,N as B,X as G,e as T,t as A,f as E,A as y}from"./chunk-BP2vJgP3.js";/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["path",{d:"M12 12h.01",key:"1mp3jc"}]],V=L("Dice1",z);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22",key:"1ailkh"}],["path",{d:"M2 6h1.972a4 4 0 0 1 3.6 2.2",key:"km57vx"}],["path",{d:"M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45",key:"os18l9"}]],K=L("Shuffle",Q);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]],J=L("Trash",X),D=["h1","h2","h3","h4","h5","h6"],W=["strong","span","p","div"],Y={base:"",variants:{$as:{h1:"text-3xl md:text-4xl font-bold",h2:"text-2xl md:text-3xl font-bold",h3:"text-xl md:text-2xl font-bold",h4:"text-lg md:text-xl font-bold",h5:"text-lg font-bold",h6:"text-base font-bold",blank:""}}},Z=R({elements:[...W,...D],variantsConfig:Y}),ee=({as:e,variant:t,...r})=>{const s=D.includes(e),d=t||(s?e:"blank"),c=Z[e]||null;return a.jsx(c,{$as:d,...r,children:r.children})},F=e=>({as:t=e,...r})=>a.jsx(ee,{as:t,...t!==e?{variant:e}:{},...r}),ie=F("h1"),te=F("h4");function P(e,t){const[r,s,d]=e.split(":").map(Number),c=t*4;return r*c+s*4+(d||0)}function se(e,t){const r=[];for(let s=0;s<e.length;s+=t)r.push(e.slice(s,s+t));return r}function _(e,t){return`m${e}-s${t}`}const ne=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];Array.from({length:9},(e,t)=>t);const O=[1,2,3,4],ae=({measures:e,sequencer:t,setSequencerMeasures:r,setSequencerSteps:s,setActiveStep:d})=>{const{timeSignature:c,loopLength:h}=I(),g=o.useMemo(()=>c*h,[c,h]),m=o.useMemo(()=>g*e,[g,e]);o.useEffect(()=>{!t||!c||l(e)},[t,c,e]);const l=o.useCallback(u=>{var b;if(!t)return;r(u),t.setMeasureCount(u),s(t.getSteps());const S=(b=v.toneTransport)==null?void 0:b.position;if(S){const k=P(S,c),M=u*c*h,N=k%M;d(Math.floor(N))}else d(0)},[s,r,d,c,h,t]),i=o.useMemo(()=>O.map(u=>()=>l(u)),[l]),p=o.useCallback(()=>{if(!t)return;const S=t.getSteps().map(b=>b===!0?!0:Math.random()<.25);t.setAllSteps(S),s(t.getSteps())},[s,t]),f=o.useCallback(()=>{if(!t)return;const u=Array.from({length:m},()=>Math.random()<.5);t.setAllSteps(u),s(t.getSteps())},[m,s,t]),j=o.useCallback(()=>{t&&(t.setAllSteps(Array.from({length:m},()=>!1)),s(t.getSteps()))},[m,s,t]);return a.jsxs("div",{className:"flex gap-2 justify-between flex-wrap my-4",children:[a.jsx("div",{className:"flex items-center gap-2",children:O.map((u,S)=>a.jsxs(x,{color:u===e?"warning":"secondary",onClick:i[S],children:[u," measure",u>1?"s":""]},`m-${u}`))}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(x,{color:"success",onClick:f,children:[a.jsx(K,{className:"inline-block w-4 h-4 mr-2"}),"Randomize"]}),a.jsxs(x,{color:"success",onClick:p,children:[a.jsx(V,{className:"inline-block w-4 h-4 mr-2"}),"Fill Empty"]}),a.jsxs(x,{color:"error",onClick:j,children:[a.jsx(J,{className:"inline-block w-4 h-4 mr-2"}),"Clear"]})]})]})},re=({sequencer:e})=>{const[t,r]=o.useState("G"),[s,d]=o.useState(4),c=o.useCallback((l,i)=>{i>s&&d(f=>f+1),i<s&&d(f=>f-1);const p=`${l}${i}`;e&&e.changeNote(p)},[e,s]),h=o.useCallback(l=>{const i=l.target.value;r(i),c(i,s)},[s,c]),g=o.useCallback(()=>{c(t,s-1)},[t,s,c]),m=o.useCallback(()=>{c(t,s+1)},[t,s,c]);return o.useEffect(()=>{if(!e)return;const l=e.getNote();if(typeof l=="string"){const i=l.match(/^([A-G]#?)(\d)$/);i&&(r(i[1]),d(Number.parseInt(i[2],10)))}},[e]),a.jsxs("div",{className:"flex justify-start gap-4 mb-5",children:[a.jsxs("div",{className:"flex items-center justify-between w-34",children:[a.jsx("label",{htmlFor:"note-select",className:"text-sm whitespace-nowrap",children:"Note:"}),a.jsx(U,{className:"rounded w-20 py-0.5 h-auto",id:"note-select",value:t,onChange:h,children:ne.map(l=>a.jsx("option",{value:l,children:l},l))})]}),a.jsx("div",{className:"w-40",children:a.jsx(B,{label:"Octave:",value:s,id:"step",onDecrease:g,onIncrease:m})})]})},oe=G.button.variants({base:"inset-0 absolute z-2",variants:{$state:{current:e=>`${e.$armed?"bg-primaryLight":"bg-light hover:bg-warning/50"}`,inactive:e=>`${e.$armed?"bg-primary/70":"bg-gray/50 hover:bg-warning/50"}`,halfs:e=>`${e.$armed?"bg-secondary":"bg-grayContrast hover:bg-warning/50"}`,fourths:e=>`${e.$armed?"bg-secondary":"bg-grayContrast hover:bg-warning/50"}`,eigths:e=>`${e.$armed?"bg-secondary/80":"bg-gray/50 hover:bg-warning/50"}`}}}),ce=({activeStep:e,steps:t,sequencer:r,setSequencerSteps:s})=>{const{timeSignature:d,loopLength:c}=I(),h=o.useMemo(()=>d*c,[d,c]);o.useEffect(()=>{r&&s(r.getSteps())},[r,s]);const g=o.useCallback(i=>{if(!r)return;const p=Number(i.currentTarget.dataset.stepIndex);r.toggleStep(p),s(r.getSteps())},[s,r]),m=o.useMemo(()=>Array.from({length:t.length},(i,p)=>({originalIndex:p})),[t]),l=o.useMemo(()=>se(m,h),[m,h]);return a.jsx("div",{className:"flex flex-col gap-1",children:l.map((i,p)=>a.jsx("div",{className:"lg:flex lg:mb-0 mb-3 gap-1 min-h-20 grid grid-cols-8",children:i.map((f,j)=>{const u=f.originalIndex,S=e===u,b=t[u],k=_(p,j),M=u===0,N=u%4===0,H=u%2===0;let n;return S?n="current":N?n="fourths":H?n="eigths":M?n="halfs":n="inactive",a.jsx("div",{className:"relative flex-1",children:a.jsx(oe,{$state:n,$armed:b,"data-step-index":u,onClick:g})},k)})},_(p,0)))})},ue=({...e})=>{const{timeSignature:t,isPlaying:r,loopLength:s,transport:d}=I(),[c,h]=o.useState(0),g=o.useMemo(()=>t*s,[t,s]),m=o.useMemo(()=>g*e.measures,[g,e.measures]);return o.useEffect(()=>{function l(){h(i=>(i+1)%m)}return v.emitter.on("sixteenthTick",l),()=>{v.emitter.off("sixteenthTick",l)}},[m]),o.useEffect(()=>{r&&h(0)},[r]),o.useEffect(()=>{if(!d)return;const l=d.position,p=P(l,t)%m;h(Math.floor(p))},[t,m,d]),a.jsxs("div",{className:"p-4 border-grayDark bg-black border-1",children:[a.jsx(re,{sequencer:e.sequencer}),a.jsx(ae,{measures:e.measures,setSequencerMeasures:e.setSequencerMeasures,setSequencerSteps:e.setSequencerSteps,setActiveStep:h,sequencer:e.sequencer}),a.jsx(ce,{sequencer:e.sequencer,setSequencerSteps:e.setSequencerSteps,activeStep:c,steps:e.steps})]})},C=T()(e=>({steps:A,setSteps:t=>e(()=>({steps:t})),measures:E.loopLength.default,setMeasures:t=>e(()=>({measures:t}))})),$=T()(e=>({steps:A,setSteps:t=>e(()=>({steps:t})),measures:E.loopLength.default,setMeasures:t=>e(()=>({measures:t}))})),w=T()(e=>({steps:A,setSteps:t=>e(()=>({steps:t})),measures:E.loopLength.default,setMeasures:t=>e(()=>({measures:t}))})),q=T()(e=>({steps:A,setSteps:t=>e(()=>({steps:t})),measures:E.loopLength.default,setMeasures:t=>e(()=>({measures:t}))})),de=()=>{const{isInitialized:e}=I(),t=C(n=>n.steps),r=C(n=>n.setSteps),s=C(n=>n.measures),d=C(n=>n.setMeasures),c=$(n=>n.steps),h=$(n=>n.setSteps),g=$(n=>n.measures),m=$(n=>n.setMeasures),l=w(n=>n.steps),i=w(n=>n.setSteps),p=w(n=>n.measures),f=w(n=>n.setMeasures),j=q(n=>n.steps),u=q(n=>n.setSteps),S=q(n=>n.measures),b=q(n=>n.setMeasures),k=e?v.getSequencer1():null,M=e?v.getSequencer2():null,N=e?v.getSequencer3():null,H=e?v.getSequencer4():null;return{sequencer1:k,sequencer1Steps:t,setSequencer1Steps:r,sequencer1Measures:s,setSequencer1Measures:d,sequencer2:M,sequencer2Steps:c,setSequencer2Steps:h,sequencer2Measures:g,setSequencer2Measures:m,sequencer3:N,sequencer3Steps:l,setSequencer3Steps:i,sequencer3Measures:p,setSequencer3Measures:f,sequencer4:H,sequencer4Steps:j,setSequencer4Steps:u,sequencer4Measures:S,setSequencer4Measures:b}},he=()=>a.jsxs("div",{className:"flex gap-3 items-center flex-wrap mb-10",children:[a.jsx(te,{children:"Choose Sequencer"}),a.jsxs("div",{className:"flex gap-2 items-center",children:[a.jsx(x,{color:"secondary",link:`${y.viteUrl}/`,children:"All Sequencers"}),a.jsx(x,{link:`${y.viteUrl}/sequencer-1/`,children:"Sequencer 1"}),a.jsx(x,{link:`${y.viteUrl}/sequencer-2/`,children:"Sequencer 2"}),a.jsx(x,{link:`${y.viteUrl}/sequencer-3/`,children:"Sequencer 3"}),a.jsx(x,{link:`${y.viteUrl}/sequencer-4/`,children:"Sequencer 4"})]})]});export{ie as H,he as S,ue as a,de as u};
