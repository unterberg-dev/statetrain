import{c as P,Q as U,j as s,d as D,r as a,T as G,B as v,S as Q,N as X,X as T,A as w}from"./chunk-DzTJcogl.js";/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["path",{d:"M12 12h.01",key:"1mp3jc"}]],J=P("Dice1",K);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22",key:"1ailkh"}],["path",{d:"M2 6h1.972a4 4 0 0 1 3.6 2.2",key:"km57vx"}],["path",{d:"M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45",key:"os18l9"}]],Y=P("Shuffle",W);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]],q=P("Trash",Z),I=["h1","h2","h3","h4","h5","h6"],ee=["strong","span","p","div"],te={base:"",variants:{$as:{h1:"text-3xl md:text-4xl font-bold",h2:"text-2xl md:text-3xl font-bold",h3:"text-xl md:text-2xl font-bold",h4:"text-lg md:text-xl font-bold",h5:"text-lg font-bold",h6:"text-base font-bold",blank:""}}},ne=U({elements:[...ee,...I],variantsConfig:te}),se=({as:e,variant:t,...r})=>{const n=I.includes(e),o=t||(n?e:"blank"),l=ne[e]||null;return s.jsx(l,{$as:o,...r,children:r.children})},R=e=>({as:t=e,...r})=>s.jsx(se,{as:t,...t!==e?{variant:e}:{},...r}),ye=R("h1"),ke=R("h2"),je=R("h3"),ae=R("h4");function F(e,t){const[r,n,o]=e.split(":").map(Number),l=t*4;return r*l+n*4+(o||0)}function re(e,t){const r=[];for(let n=0;n<e.length;n+=t)r.push(e.slice(n,n+t));return r}function L(e,t){return`m${e}-s${t}`}const le=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];Array.from({length:9},(e,t)=>t);const _=[1,2,3,4],oe=({measures:e,sequencer:t,setSequencerMeasures:r,setSequencerSteps:n,setActiveStep:o})=>{const{timeSignature:l,loopLength:g}=D(),S=a.useMemo(()=>l*g,[l,g]),p=a.useMemo(()=>S*e,[S,e]);a.useEffect(()=>{!t||!l||h(e)},[t,l,e]);const h=a.useCallback(c=>{var m;if(!t)return;r(c),t.setMeasureCount(c),n(t.getSteps());const u=(m=G.toneTransport)==null?void 0:m.position;if(u){const j=F(u,l),C=c*l*g,N=j%C;o(Math.floor(N))}else o(0)},[n,r,o,l,g,t]),d=a.useMemo(()=>_.map(c=>()=>h(c)),[h]),f=a.useCallback(()=>{if(!t)return;const u=t.getSteps().map(m=>m===!0?!0:Math.random()<.25);t.setAllSteps(u),n(t.getSteps())},[n,t]),x=a.useCallback(()=>{if(!t)return;const c=Array.from({length:p},()=>Math.random()<.5);t.setAllSteps(c),n(t.getSteps())},[p,n,t]),y=a.useCallback(()=>{t&&(t.setAllSteps(Array.from({length:p},()=>!1)),n(t.getSteps()))},[p,n,t]);return s.jsxs("div",{className:"flex gap-2 justify-between flex-wrap my-4",children:[s.jsx("div",{className:"flex items-center gap-2",children:_.map((c,u)=>s.jsxs(v,{color:c===e?"warning":"secondary",onClick:d[u],children:[c," measure",c>1?"s":""]},`m-${c}`))}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(v,{color:"success",onClick:x,children:[s.jsx(Y,{className:"inline-block w-4 h-4 mr-2"}),"Randomize"]}),s.jsxs(v,{color:"success",onClick:f,children:[s.jsx(J,{className:"inline-block w-4 h-4 mr-2"}),"Fill Empty"]}),s.jsxs(v,{color:"error",onClick:y,children:[s.jsx(q,{className:"inline-block w-4 h-4 mr-2"}),"Clear"]})]})]})},ce=({sequencer:e})=>{const[t,r]=a.useState("G"),[n,o]=a.useState(4),l=a.useCallback((h,d)=>{d>n&&o(x=>x+1),d<n&&o(x=>x-1);const f=`${h}${d}`;e&&e.changeNote(f)},[e,n]),g=a.useCallback(h=>{const d=h.target.value;r(d),l(d,n)},[n,l]),S=a.useCallback(()=>{l(t,n-1)},[t,n,l]),p=a.useCallback(()=>{l(t,n+1)},[t,n,l]);return a.useEffect(()=>{if(!e)return;const h=e.getNote();if(typeof h=="string"){const d=h.match(/^([A-G]#?)(\d)$/);d&&(r(d[1]),o(Number.parseInt(d[2],10)))}},[e]),s.jsxs("div",{className:"flex justify-start gap-4",children:[s.jsxs("div",{className:"flex items-center justify-between w-34",children:[s.jsx("label",{htmlFor:"note-select",className:"text-sm whitespace-nowrap",children:"Note:"}),s.jsx(Q,{className:"rounded w-20 py-0.5 h-auto",id:"note-select",value:t,onChange:g,children:le.map(h=>s.jsx("option",{value:h,children:h},h))})]}),s.jsx("div",{className:"w-40",children:s.jsx(X,{label:"Octave:",value:n,id:"step",onDecrease:S,onIncrease:p})})]})},ie=T.button.variants({base:`inset-0 absolute z-2 transition-all rounded-sm ${w.transition.twShort}`,variants:{$state:{current:e=>`
        ${e.$armed?"bg-primaryLight":"bg-light hover:bg-warning/50"}
        !-translate-y-2
      `,inactive:e=>`${e.$armed?"bg-secondary/50":"bg-grayDark hover:bg-secondaryLight/50"}`,halfs:e=>`${e.$armed?"bg-secondary":"bg-grayDark hover:bg-secondaryLight/50"}`,fourths:e=>`${e.$armed?"bg-secondary":"bg-grayContrast hover:bg-secondaryLight/50"}`,eigths:e=>`${e.$armed?"bg-secondary/60":"bg-grayContrast/50 hover:bg-secondaryLight/50"}`}}}),de=({activeStep:e,steps:t,sequencer:r,setSequencerSteps:n})=>{const{timeSignature:o,loopLength:l}=D(),g=a.useMemo(()=>o*l,[o,l]);a.useEffect(()=>{r&&n(r.getSteps())},[r,n]);const S=a.useCallback(d=>{if(!r)return;const f=Number(d.currentTarget.dataset.stepIndex);r.toggleStep(f),n(r.getSteps())},[n,r]),p=a.useMemo(()=>Array.from({length:t.length},(d,f)=>({originalIndex:f})),[t]),h=a.useMemo(()=>re(p,g),[p,g]);return s.jsx("div",{className:"flex flex-col gap-1",children:h.map((d,f)=>s.jsx("div",{className:"lg:flex lg:mb-0 mb-3 gap-1 min-h-20 grid grid-cols-8",children:d.map((x,y)=>{const c=x.originalIndex,u=e===c,m=t[c],j=L(f,y),C=c===0,N=c%4===0,V=c%2===0;let k;return u?k="current":N?k="fourths":V?k="eigths":C?k="halfs":k="inactive",s.jsx("div",{className:"relative flex-1",children:s.jsx(ie,{$state:k,$armed:m,"data-step-index":c,onClick:S})},j)})},L(f,0)))})},H=(e,t,r)=>Number(((e-t)/(r-t)*100).toFixed(2)),he=T.div`
  slider
  relative
  w-[200px]
`,ue=T.div`
  slider__track
  absolute
  rounded-sm
  cursor-pointer
  w-full
  h-[7px]
  bg-grayDark
  hover:bg-gray:50
`,me=T.div`
  slider__range
  absolute
  rounded-sm
  cursor-pointer
  h-[7px]
  bg-primary
  hover:bg-primaryLight/70
`,A=T.input`
  thumb
  thumb::-webkit-slider-thumb
  -webkit-appearance: none;
  pointer-events: none;
  position: absolute;
  height: 0;
  width: auto;
  outline: none;
`,ge={min:0,max:100},fe=({multi:e,step:t=1,onChange:r,initialValue:n})=>{const{min:o,max:l}=ge,[g,S]=a.useState(o),[p,h]=a.useState(l),[d,f]=a.useState((o+l)/2),[x,y]=a.useState(!1),c=a.useRef(o),u=a.useRef(l),m=a.useRef(null),j=a.useRef(null);console.log(n);const C=a.useCallback(i=>{const b=H(i,o,l);m.current&&(m.current.style.left="0%",m.current.style.width=`${b}%`)},[l,o]),N=a.useCallback((i,b)=>{const M=H(i,o,l),$=H(b,o,l);m.current&&(m.current.style.left=`${M}%`,m.current.style.width=`${$-M}%`)},[l,o]),V=a.useCallback(i=>{x||y(!0);const b=Math.max(Number(i),g+1);r(b),f(b),C(b)},[C,x,g,r]),k=a.useCallback((i,b)=>{x||y(!0);const M=5;if(b==="min"){if(i>=u.current-M)return;S(Math.min(i,u.current-1)),r(i,"min"),N(i,u.current),c.current=i}else{if(i<=c.current+M)return;h(Math.max(i,c.current+1)),r(i,"max"),N(c.current,i),u.current=i}},[N,x,r]);a.useEffect(()=>{if(e){if(N(g,p),n&&!x){const[i,b]=n;S(i),h(b),c.current=i,u.current=b}}else C(d),n&&!x&&f(n)},[N,C,n,x,p,g,e,d]);const E={type:"range",min:o,max:l,step:t},O=i=>{if(!j.current)return;const b=j.current.getBoundingClientRect(),M=i.clientX-b.left,$=Math.round(M/b.width*(l-o)+o);if(e){const z=Math.abs($-g),B=Math.abs($-p);z<B?k($,"min"):k($,"max")}else V($)};return s.jsxs("div",{className:"py-3",children:[e?s.jsxs(s.Fragment,{children:[s.jsx(A,{value:g,onChange:i=>k(Number(i.target.value),"min"),className:"thumb thumb--left z-3",...E}),s.jsx(A,{value:p,onChange:i=>k(Number(i.target.value),"max"),className:"thumb thumb--right z-4",...E})]}):s.jsx(A,{value:d,onChange:i=>V(Number(i.target.value)),className:"thumb thumb--single z-4",...E}),s.jsxs(he,{ref:j,onClick:O,children:[s.jsx(ue,{}),s.jsx(me,{ref:m})]})]})},xe=(e,t,r)=>e/100*(r-t)+t,pe=(e,t,r)=>Number(((e-t)/(r-t)*100).toFixed(2)),be=e=>pe(e.value,e.min,e.max),Ne=({sequencer:e,volume:t,setVolume:r,...n})=>{const{timeSignature:o,isPlaying:l,loopLength:g,transport:S,registerSixteenthTick:p,unregisterSixteenthTick:h}=D(),[d,f]=a.useState(),x=a.useMemo(()=>o*g,[o,g]),y=a.useMemo(()=>x*n.measures,[x,n.measures]);a.useEffect(()=>{function u(){f(m=>typeof m=="number"?(m+1)%y:0)}return p(u),()=>{h(u)}},[y,p,h]),a.useEffect(()=>{l&&f(0)},[l]),a.useEffect(()=>{if(!S)return;const u=S.position,j=F(u,o)%y;f(Math.floor(j))},[o,y,S]);const c=a.useCallback(u=>{if(e){r(u);const m=xe(u,-50,20);console.log("interpolatedValue",m),e.setVolume(m)}},[e,r]);return s.jsxs("div",{className:"p-4 border-grayDark bg-black border-1",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx(ce,{sequencer:e}),s.jsxs("div",{className:"flex gap-2 items-center",children:[s.jsx("span",{className:"text-sm pt-1 text-grayLight",children:"Volume"}),s.jsx(fe,{onChange:c,initialValue:t||be({min:-50,max:20,value:0})})]})]}),s.jsx(oe,{measures:n.measures,setSequencerMeasures:n.setSequencerMeasures,setSequencerSteps:n.setSequencerSteps,setActiveStep:f,sequencer:e}),s.jsx(de,{sequencer:e,setSequencerSteps:n.setSequencerSteps,activeStep:d,steps:n.steps})]})},ve=()=>s.jsxs("div",{className:"flex gap-3 items-center flex-wrap mb-10",children:[s.jsx(ae,{children:"Choose Sequencer"}),s.jsxs("div",{className:"flex gap-2 items-center",children:[s.jsx(v,{color:"secondary",link:`${w.viteUrl}/`,children:"All Sequencers"}),s.jsx(v,{link:`${w.viteUrl}/sequencer-1/`,children:"Sequencer 1"}),s.jsx(v,{link:`${w.viteUrl}/sequencer-2/`,children:"Sequencer 2"}),s.jsx(v,{link:`${w.viteUrl}/sequencer-3/`,children:"Sequencer 3"}),s.jsx(v,{link:`${w.viteUrl}/sequencer-4/`,children:"Sequencer 4"})]})]});export{je as H,ve as S,ke as a,ye as b,Ne as c};
