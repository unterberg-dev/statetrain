import{c as D,Q as R,j as a,d as I,r as c,T as N,B as x,S as U,N as B,X as G,A as k,e as T,t as A,f as H}from"./chunk-D1yRyRIL.js";/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["path",{d:"M12 12h.01",key:"1mp3jc"}]],V=D("Dice1",z);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22",key:"1ailkh"}],["path",{d:"M2 6h1.972a4 4 0 0 1 3.6 2.2",key:"km57vx"}],["path",{d:"M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45",key:"os18l9"}]],K=D("Shuffle",Q);/**
 * @license lucide-react v0.473.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]],J=D("Trash",X),F=["h1","h2","h3","h4","h5","h6"],W=["strong","span","p","div"],Y={base:"",variants:{$as:{h1:"text-3xl md:text-4xl font-bold",h2:"text-2xl md:text-3xl font-bold",h3:"text-xl md:text-2xl font-bold",h4:"text-lg md:text-xl font-bold",h5:"text-lg font-bold",h6:"text-base font-bold",blank:""}}},Z=R({elements:[...W,...F],variantsConfig:Y}),ee=({as:e,variant:t,...r})=>{const s=F.includes(e),d=t||(s?e:"blank"),o=Z[e]||null;return a.jsx(o,{$as:d,...r,children:r.children})},E=e=>({as:t=e,...r})=>a.jsx(ee,{as:t,...t!==e?{variant:e}:{},...r}),ie=E("h1"),ue=E("h2"),de=E("h3"),te=E("h4");function P(e,t){const[r,s,d]=e.split(":").map(Number),o=t*4;return r*o+s*4+(d||0)}function se(e,t){const r=[];for(let s=0;s<e.length;s+=t)r.push(e.slice(s,s+t));return r}function _(e,t){return`m${e}-s${t}`}const ne=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];Array.from({length:9},(e,t)=>t);const O=[1,2,3,4],ae=({measures:e,sequencer:t,setSequencerMeasures:r,setSequencerSteps:s,setActiveStep:d})=>{const{timeSignature:o,loopLength:p}=I(),S=c.useMemo(()=>o*p,[o,p]),m=c.useMemo(()=>S*e,[S,e]);c.useEffect(()=>{!t||!o||u(e)},[t,o,e]);const u=c.useCallback(i=>{var b;if(!t)return;r(i),t.setMeasureCount(i),s(t.getSteps());const f=(b=N.toneTransport)==null?void 0:b.position;if(f){const j=P(f,o),v=i*o*p,M=j%v;d(Math.floor(M))}else d(0)},[s,r,d,o,p,t]),l=c.useMemo(()=>O.map(i=>()=>u(i)),[u]),h=c.useCallback(()=>{if(!t)return;const f=t.getSteps().map(b=>b===!0?!0:Math.random()<.25);t.setAllSteps(f),s(t.getSteps())},[s,t]),g=c.useCallback(()=>{if(!t)return;const i=Array.from({length:m},()=>Math.random()<.5);t.setAllSteps(i),s(t.getSteps())},[m,s,t]),y=c.useCallback(()=>{t&&(t.setAllSteps(Array.from({length:m},()=>!1)),s(t.getSteps()))},[m,s,t]);return a.jsxs("div",{className:"flex gap-2 justify-between flex-wrap my-4",children:[a.jsx("div",{className:"flex items-center gap-2",children:O.map((i,f)=>a.jsxs(x,{color:i===e?"warning":"secondary",onClick:l[f],children:[i," measure",i>1?"s":""]},`m-${i}`))}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(x,{color:"success",onClick:g,children:[a.jsx(K,{className:"inline-block w-4 h-4 mr-2"}),"Randomize"]}),a.jsxs(x,{color:"success",onClick:h,children:[a.jsx(V,{className:"inline-block w-4 h-4 mr-2"}),"Fill Empty"]}),a.jsxs(x,{color:"error",onClick:y,children:[a.jsx(J,{className:"inline-block w-4 h-4 mr-2"}),"Clear"]})]})]})},re=({sequencer:e})=>{const[t,r]=c.useState("G"),[s,d]=c.useState(4),o=c.useCallback((u,l)=>{l>s&&d(g=>g+1),l<s&&d(g=>g-1);const h=`${u}${l}`;e&&e.changeNote(h)},[e,s]),p=c.useCallback(u=>{const l=u.target.value;r(l),o(l,s)},[s,o]),S=c.useCallback(()=>{o(t,s-1)},[t,s,o]),m=c.useCallback(()=>{o(t,s+1)},[t,s,o]);return c.useEffect(()=>{if(!e)return;const u=e.getNote();if(typeof u=="string"){const l=u.match(/^([A-G]#?)(\d)$/);l&&(r(l[1]),d(Number.parseInt(l[2],10)))}},[e]),a.jsxs("div",{className:"flex justify-start gap-4 mb-5",children:[a.jsxs("div",{className:"flex items-center justify-between w-34",children:[a.jsx("label",{htmlFor:"note-select",className:"text-sm whitespace-nowrap",children:"Note:"}),a.jsx(U,{className:"rounded w-20 py-0.5 h-auto",id:"note-select",value:t,onChange:p,children:ne.map(u=>a.jsx("option",{value:u,children:u},u))})]}),a.jsx("div",{className:"w-40",children:a.jsx(B,{label:"Octave:",value:s,id:"step",onDecrease:S,onIncrease:m})})]})},oe=G.button.variants({base:`inset-0 absolute z-2 transition-all rounded-sm ${k.transition.twShort}`,variants:{$state:{current:e=>`
        ${e.$armed?"bg-primaryLight":"bg-light hover:bg-warning/50"}
        !-translate-y-2
      `,inactive:e=>`${e.$armed?"bg-secondary/50":"bg-grayDark hover:bg-secondaryLight/50"}`,halfs:e=>`${e.$armed?"bg-secondary":"bg-grayDark hover:bg-secondaryLight/50"}`,fourths:e=>`${e.$armed?"bg-secondary":"bg-grayContrast hover:bg-secondaryLight/50"}`,eigths:e=>`${e.$armed?"bg-secondary/60":"bg-grayContrast/50 hover:bg-secondaryLight/50"}`}}}),ce=({activeStep:e,steps:t,sequencer:r,setSequencerSteps:s})=>{const{timeSignature:d,loopLength:o}=I(),p=c.useMemo(()=>d*o,[d,o]);c.useEffect(()=>{r&&s(r.getSteps())},[r,s]);const S=c.useCallback(l=>{if(!r)return;const h=Number(l.currentTarget.dataset.stepIndex);r.toggleStep(h),s(r.getSteps())},[s,r]),m=c.useMemo(()=>Array.from({length:t.length},(l,h)=>({originalIndex:h})),[t]),u=c.useMemo(()=>se(m,p),[m,p]);return a.jsx("div",{className:"flex flex-col gap-1",children:u.map((l,h)=>a.jsx("div",{className:"lg:flex lg:mb-0 mb-3 gap-1 min-h-20 grid grid-cols-8",children:l.map((g,y)=>{const i=g.originalIndex,f=e===i,b=t[i],j=_(h,y),v=i===0,M=i%4===0,L=i%2===0;let n;return f?n="current":M?n="fourths":L?n="eigths":v?n="halfs":n="inactive",a.jsx("div",{className:"relative flex-1",children:a.jsx(oe,{$state:n,$armed:b,"data-step-index":i,onClick:S})},j)})},_(h,0)))})},he=({...e})=>{const{timeSignature:t,isPlaying:r,loopLength:s,transport:d,registerSixteenthTick:o,unregisterSixteenthTick:p}=I(),[S,m]=c.useState(),u=c.useMemo(()=>t*s,[t,s]),l=c.useMemo(()=>u*e.measures,[u,e.measures]);return c.useEffect(()=>{function h(){m(g=>typeof g=="number"?(g+1)%l:0)}return o(h),()=>{p(h)}},[l,o,p]),c.useEffect(()=>{r&&m(0)},[r]),c.useEffect(()=>{if(!d)return;const h=d.position,y=P(h,t)%l;m(Math.floor(y))},[t,l,d]),a.jsxs("div",{className:"p-4 border-grayDark bg-black border-1",children:[a.jsx(re,{sequencer:e.sequencer}),a.jsx(ae,{measures:e.measures,setSequencerMeasures:e.setSequencerMeasures,setSequencerSteps:e.setSequencerSteps,setActiveStep:m,sequencer:e.sequencer}),a.jsx(ce,{sequencer:e.sequencer,setSequencerSteps:e.setSequencerSteps,activeStep:S,steps:e.steps})]})},C=T()(e=>({steps:A,setSteps:t=>e(()=>({steps:t})),measures:H.loopLength.default,setMeasures:t=>e(()=>({measures:t}))})),$=T()(e=>({steps:A,setSteps:t=>e(()=>({steps:t})),measures:H.loopLength.default,setMeasures:t=>e(()=>({measures:t}))})),q=T()(e=>({steps:A,setSteps:t=>e(()=>({steps:t})),measures:H.loopLength.default,setMeasures:t=>e(()=>({measures:t}))})),w=T()(e=>({steps:A,setSteps:t=>e(()=>({steps:t})),measures:H.loopLength.default,setMeasures:t=>e(()=>({measures:t}))})),me=()=>{const{isInitialized:e}=I(),t=C(n=>n.steps),r=C(n=>n.setSteps),s=C(n=>n.measures),d=C(n=>n.setMeasures),o=$(n=>n.steps),p=$(n=>n.setSteps),S=$(n=>n.measures),m=$(n=>n.setMeasures),u=q(n=>n.steps),l=q(n=>n.setSteps),h=q(n=>n.measures),g=q(n=>n.setMeasures),y=w(n=>n.steps),i=w(n=>n.setSteps),f=w(n=>n.measures),b=w(n=>n.setMeasures),j=e?N.getSequencer1():null,v=e?N.getSequencer2():null,M=e?N.getSequencer3():null,L=e?N.getSequencer4():null;return{sequencer1:j,sequencer1Steps:t,setSequencer1Steps:r,sequencer1Measures:s,setSequencer1Measures:d,sequencer2:v,sequencer2Steps:o,setSequencer2Steps:p,sequencer2Measures:S,setSequencer2Measures:m,sequencer3:M,sequencer3Steps:u,setSequencer3Steps:l,sequencer3Measures:h,setSequencer3Measures:g,sequencer4:L,sequencer4Steps:y,setSequencer4Steps:i,sequencer4Measures:f,setSequencer4Measures:b}},pe=()=>a.jsxs("div",{className:"flex gap-3 items-center flex-wrap mb-10",children:[a.jsx(te,{children:"Choose Sequencer"}),a.jsxs("div",{className:"flex gap-2 items-center",children:[a.jsx(x,{color:"secondary",link:`${k.viteUrl}/`,children:"All Sequencers"}),a.jsx(x,{link:`${k.viteUrl}/sequencer-1/`,children:"Sequencer 1"}),a.jsx(x,{link:`${k.viteUrl}/sequencer-2/`,children:"Sequencer 2"}),a.jsx(x,{link:`${k.viteUrl}/sequencer-3/`,children:"Sequencer 3"}),a.jsx(x,{link:`${k.viteUrl}/sequencer-4/`,children:"Sequencer 4"})]})]});export{de as H,pe as S,ue as a,ie as b,he as c,me as u};
